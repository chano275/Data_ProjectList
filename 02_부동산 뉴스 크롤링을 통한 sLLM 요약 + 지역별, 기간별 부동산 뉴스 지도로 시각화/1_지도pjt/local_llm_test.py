from huggingface_hub import login
from transformers import AutoTokenizer, AutoModelForCausalLM
import torch

login(token="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")
model_name = "maum-ai/Llama-3-MAAL-8B-Instruct-v0.1"

# 토크나이저 로드
tokenizer = AutoTokenizer.from_pretrained(model_name)

# 모델 로드
model = AutoModelForCausalLM.from_pretrained(
    model_name,
    torch_dtype=torch.float16,
    device_map="auto"
)

# 입력 프롬프트 정의
prompt = "서울 남산에서 바라본 시내 아파트 단지 모습. 연합뉴스올해 서울 용산구 아파트를 21억원에 매수한 A씨는 모친에게서 14억원을 차입하고, " \
         "증여 받은 5억5000만원, 주택담보대출 3억5000만원으로 이 아파트를 사들였다. 본인 자금은 전혀 없이 전액을 타인에게 받은 현금·대출로 고가 아파트를 매수한 것이다. " \
         "정부는 이 거래를 가족 간 거래를 가장한 편법 증여로 의심하고 국세청에 통보했다.국토교통부는 지난 8월 13일부터 9월 27일까지 서울 강남 3구 및 마포·용산·성동구 일대 45개 아파트 단지에 대해 1차 현장점검을 하고, " \
         "상반기 수도권 주택 이상 거래에 대한 기획조사를 벌여 A씨 사례를 포함해 총 397건의 위법 의심 거래를 적발했다고 3일 밝혔다. 지난 7~8월 서울 등 수도권을 중심으로 아파트값이 과열되자 금융위원회·국세청·한국부동산원 등과 합동 현장점검에 나선 결과다." \
         "위법 의심거래 70%가 서울…강남, 마용성에 집중위법 행위가 의심되는 주택 거래 397건 중 절반 이상인 272건(68.5%)이 서울에서 적발됐다. 이어 경기(112건·28.2%), 인천(13건·3.3%) 순이었다. " \
         "서울에선 강남 3구(강남·서초·송파구)와 마용성(마포·용산·성동구)에서 적발 사례가 집중됐다. 강남구가 52건으로 가장 많았고, " \
         "송파구(49건), 서초구(35건), 용산구(23건), 성동구(20건), 마포구(18건), 영등포구(12건), 광진구(11건) 등의 순이었다. 경기도에선 성남 분당구(29건), 하남시(14건), 용인 수지구(7건) 등에서 나왔다." \
         " 올해 집값이 과열됐던 지역에서 위법 의심 거래가 대거 적발된 셈이다.김경진 기자위법 행위 유형은 편법 증여, 법인자금 유용 의심 사례가 가장 많았고, 계약일 거짓 신고, 대출 규정 위반 및 대출 용도 외 유용, 중개수수료 초과 수수 등이었다." \
         "서울 강남구 아파트를 사기 위해 대출 규정을 위반한 사례는 이랬다. 부부 관계인 매수인 B·C씨는 서울 강남구 아파트에 임차인으로 거주 중인 부친의 전세를 끼고 이 아파트를 사기 위해 감정평가를 받았다." \
         " 평가금액은 22억원으로 규제지역 주택담보인정비율(LTV) 한도는 11억원이었다. 하지만 선순위 임차보증금(8억5000만원)이 있어 주택담보대출 5억원을 못 받을 것을 우려한 이들은 대출 전 아파트에 거주 중인 임차인(매수인의 부친)을 " \
         "주소지에서 전출시킨 후 대출을 받고 다시 전입하게 했다.'이 가격 아래로는 팔지마' 가격 담함도국토부는 이 거래를 대출 규정 위반으로 보고 금융위에 통보했다. " \
         "또 매수인은 주택 가격도 거짓으로 신고해 거래신고법 위반 및 탈세의심으로 지자체와 국세청 통보됐다.또 서울 송파구의 한 아파트 단지 입주민들은 오픈채팅방을 만들어 특정 가격 이하로 매도하지 않도록 집값을 담함한 의심 정황이 포착돼 " \
         "공인중개사법 위반으로 지차제의 추가 조사를 받고 있다.박경민 기자국토부는 이번 관계기관 합동 현장점검을 최근 가격 상승세가 이어지고 있는 1기 신도시 등을 포함한 수도권 전 지역으로 확대해 연말까지 계속 이어갈 것이라고 밝혔다. " \
         "올해 하반기 거래 신고분에 대한 기획조사도 내년 4월까지 지속한다.정부는 이날 지난해 하반기 전국 아파트 거래 18만7000건 대상으로, 집값 띄우기 우려가 있는 미등기 거래와 편법 증여 가능성이 있는 직거래 조사를 실시한 결과도 발표했다." \
         "미등기 거래는 518건으로(전체 거래의 0.28%) 2022년 하반기(1183건)와 비교하면 56% 감소했다. 2020년부터 실시 중인 미등기 아파트에 대한 지속적인 조사와 올해 1월 이후 거래분에 대해선 실거래가 공개 시스템을 통해 등기여부(등기일)를 공개하는 등 제도 개선 영향이 컸다는 평가다. " \
         "직거래 조사에선 160건의 위법 의심 거래를 찾아 국세청 등 관계기관에 통보했다고 밝혔다.김규철 국토부 주택토지실장은 “관계부처·지자체와 수도권 주택 이상 거래에 대한 추가 현장점검, 기획조사를 지속 실시하는 한편 연말까지 기획부동산 특별조사, " \
         "외국인 부동산 이상거래 기획조사도 실시할 계획”이라고 말했다.백민정 기자 baek.minjeong@joongang.co.kr < 이 기사에 대해 요약해줘. 추가적으로 어떤 지역에 관련되어 있는지 [] 안에 담아서 알려줘 "

# 입력 인코딩 및 장치 설정
device = "cpu"
inputs = tokenizer(prompt, return_tensors="pt").to(device)

# 텍스트 생성
with torch.no_grad():
    outputs = model.generate(
        inputs["input_ids"],
        max_length=2000,
        do_sample=True,
        top_p=0.95,
        temperature=0.8,
        num_return_sequences=1,
        eos_token_id=tokenizer.eos_token_id,
        pad_token_id=tokenizer.pad_token_id,
    )

# 결과 디코딩
generated_text = tokenizer.decode(outputs[0], skip_special_tokens=True)

# 결과 출력
print(generated_text)
print('##############################')
